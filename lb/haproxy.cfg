global
    log stdout format raw local0
    maxconn 4096

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5s
    timeout client  30s
    timeout server  30s
    retries 3

frontend http-in
    bind *:80
    default_backend gateways

backend gateways
    # Round-robin balancing across gateway replicas
    balance roundrobin
    option httpchk GET /health
    server gateway-1 gateway-1:80 check inter 2000 rise 2 fall 3
    server gateway-2 gateway-2:80 check inter 2000 rise 2 fall 3